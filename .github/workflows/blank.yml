name: Validate Merge Commit Message

on:
  pull_request:
    types: [synchronize, opened, reopened, labeled, unlabeled]

jobs:
  validate-merge-message:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Get latest commit message
      run: echo "${{ github.event.workflow_run.head_commit.message }}" > commit_message.txt

    - name: Validate commit message
      run: |
        COMMIT_MESSAGE=$(cat commit_message.txt)
        echo "Commit message: $COMMIT_MESSAGE"
        if [[ ! "$COMMIT_MESSAGE" =~ ^(fix|feat): ]]; then
          echo "‚ùå Error: Commit message does not follow conventional commits!"
          exit 1
        fi
